import React from 'react';
import { useState } from 'react';

const CardCave = ({ changeTab, cellar, getCellar }) => {

    const [nameValue, setNameValue] = useState(cellar.name)
    const changeTitle = (e) => {
        if (e.target.previousSibling.disabled) {
            e.target.previousSibling.disabled = false;
        } else {
            e.target.previousSibling.disabled = true;
            fetch('http://localhost:8000/cellars/create', {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Bearer " + localStorage.getItem("userToken")
                },
                body: JSON.stringify({
                    name: nameValue
                })
            })
                .then(res => res.json())
                .then(data => getCellar())
        }
    }

    const deleteCellar = () => {
        fetch('http://localhost:8000/cellars/' + cellar._id, {
            method: "DELETE",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer " + localStorage.getItem("userToken")
            }
        })
            .then(res => res.json())
            .then(data => getCellar())

    }

    return(
        <div className="cave-card">
            <svg className="cave-card --delete" onClick={deleteCellar} viewBox="0 0 47.971 47.971">
                <path d="M28.228,23.986L47.092,5.122c1.172-1.171,1.172-3.071,0-4.242c-1.172-1.172-3.07-1.172-4.242,0L23.986,19.744L5.121,0.88   c-1.172-1.172-3.07-1.172-4.242,0c-1.172,1.171-1.172,3.071,0,4.242l18.865,18.864L0.879,42.85c-1.172,1.171-1.172,3.071,0,4.242   C1.465,47.677,2.233,47.97,3,47.97s1.535-0.293,2.121-0.879l18.865-18.864L42.85,47.091c0.586,0.586,1.354,0.879,2.121,0.879   s1.535-0.293,2.121-0.879c1.172-1.171,1.172-3.071,0-4.242L28.228,23.986z"></path>
            </svg>
            <div>
                <h2 className="cave-card --header">
                    <input className="cave-card --header" type="text" name="" id="" value={nameValue} disabled onChange={({ currentTarget: { value } }) => setNameValue(value)}/>
                    <div className="cave-card --btn" onClick={changeTitle}></div>
                </h2>  

            </div>
            <p className="cave-card --content">Nombres de bouteilles ({cellar.maxContent} maximum)</p>

            <div className="cave-card__footer" onClick={() => changeTab("cardCave")}>
                <svg className="cave-card__footer --icon" viewBox="-27 0 512 512" >
                    <path d="m331.1875 492c-2.628906 0-5.210938 1.070312-7.070312 2.929688-1.859376 1.859374-2.929688 4.441406-2.929688 7.070312s1.070312 5.210938 2.929688 7.070312c1.859374 1.859376 4.441406 2.929688 7.070312 2.929688s5.210938-1.070312 7.070312-2.929688c1.859376-1.859374 2.929688-4.441406 2.929688-7.070312s-1.070312-5.210938-2.929688-7.070312c-1.859374-1.859376-4.441406-2.929688-7.070312-2.929688zm0 0"/>
                    <path d="m100.882812 372.152344c-16.542968 0-30 13.457031-30 30 0 16.542968 13.457032 30 30 30 16.542969 0 30-13.457032 30-30 0-16.542969-13.457031-30-30-30zm0 40c-5.515624 0-10-4.488282-10-10 0-5.515625 4.484376-10 10-10 5.511719 0 10 4.484375 10 10 0 5.511718-4.488281 10-10 10zm0 0"/>
                    <path d="m229.1875 432.152344c16.542969 0 30-13.457032 30-30 0-16.542969-13.457031-30-30-30s-30 13.457031-30 30c0 16.542968 13.457031 30 30 30zm0-40c5.511719 0 10 4.484375 10 10 0 5.511718-4.488281 10-10 10-5.515625 0-10-4.488282-10-10 0-5.515625 4.484375-10 10-10zm0 0"/>
                    <path d="m357.492188 432.152344c16.542968 0 30-13.457032 30-30 0-16.542969-13.457032-30-30-30-16.542969 0-30 13.457031-30 30 0 16.542968 13.457031 30 30 30zm0-40c5.515624 0 10 4.484375 10 10 0 5.511718-4.484376 10-10 10-5.515626 0-10-4.488282-10-10 0-5.515625 4.484374-10 10-10zm0 0"/>
                    <path d="m458.375 320.152344c0-15.355469-12.492188-27.847656-27.847656-27.847656h-22.457032c14.492188-13.542969 23.574219-32.800782 23.574219-54.152344 0-21.351563-9.082031-40.609375-23.574219-54.152344h22.457032c15.355468 0 27.847656-12.492188 27.847656-27.847656 0-15.355469-12.492188-27.847656-27.847656-27.847656h-22.457032c14.492188-13.542969 23.574219-32.800782 23.574219-54.152344 0-40.886719-33.265625-74.152344-74.152343-74.152344-27.371094 0-51.304688 14.914062-64.152344 37.035156-12.847656-22.121094-36.785156-37.035156-64.152344-37.035156-27.371094 0-51.304688 14.914062-64.152344 37.035156-12.847656-22.121094-36.785156-37.035156-64.152344-37.035156-40.886718 0-74.152343 33.265625-74.152343 74.152344 0 21.351562 9.082031 40.609375 23.570312 54.152344h-22.453125c-15.355468 0-27.847656 12.492187-27.847656 27.847656 0 15.355468 12.492188 27.847656 27.847656 27.847656h22.453125c-14.488281 13.542969-23.570312 32.800781-23.570312 54.152344 0 21.351562 9.082031 40.609375 23.570312 54.152344h-22.453125c-15.355468 0-27.847656 12.492187-27.847656 27.847656 0 15.355468 12.492188 27.847656 27.847656 27.847656h22.453125c-14.488281 13.542969-23.570312 32.800781-23.570312 54.152344 0 21.351562 9.082031 40.609375 23.570312 54.152344h-22.453125c-15.355468 0-27.847656 12.492187-27.847656 27.847656 0 15.355468 12.492188 27.847656 27.847656 27.847656h265.492188c5.519531 0 10-4.476562 10-10s-4.480469-10-10-10h-265.492188c-4.328125 0-7.847656-3.519531-7.847656-7.847656s3.519531-7.847656 7.847656-7.847656h402.679688c4.324218 0 7.847656 3.519531 7.847656 7.847656s-3.523438 7.847656-7.847656 7.847656h-61.339844c-5.523438 0-10 4.476562-10 10s4.476562 10 10 10h61.339844c15.355468 0 27.847656-12.492188 27.847656-27.847656 0-15.355469-12.492188-27.847656-27.847656-27.847656h-22.457032c14.492188-13.542969 23.574219-32.800782 23.574219-54.152344 0-21.351563-9.082031-40.609375-23.574219-54.152344h22.457032c15.355468 0 27.847656-12.492188 27.847656-27.847656zm-46.730469-82c0 29.859375-24.292969 54.152344-54.152343 54.152344-29.859376 0-54.152344-24.292969-54.152344-54.152344s24.292968-54.152344 54.152344-54.152344c29.859374 0 54.152343 24.292969 54.152343 54.152344zm-236.609375 0c0-29.859375 24.292969-54.152344 54.152344-54.152344s54.152344 24.292969 54.152344 54.152344-24.292969 54.152344-54.152344 54.152344-54.152344-24.292969-54.152344-54.152344zm3.570313 54.152344h-27.144531c5.316406-4.96875 9.898437-10.703126 13.574218-17.035157 3.675782 6.332031 8.253906 12.066407 13.570313 17.035157zm-13.570313-91.269532c-3.675781-6.328125-8.257812-12.066406-13.570312-17.035156h27.140625c-5.316407 4.96875-9.894531 10.703125-13.570313 17.035156zm114.734375-17.035156h27.140625c-5.3125 4.96875-9.894531 10.703125-13.570312 17.035156-3.675782-6.332031-8.257813-12.066406-13.570313-17.035156zm13.570313 91.269531c3.675781 6.328125 8.257812 12.066407 13.570312 17.035157h-27.144531c5.316406-4.96875 9.898437-10.703126 13.574219-17.035157zm64.152344-255.269531c29.859374 0 54.152343 24.292969 54.152343 54.152344s-24.292969 54.152344-54.152343 54.152344c-29.859376 0-54.152344-24.292969-54.152344-54.152344s24.292968-54.152344 54.152344-54.152344zm-50.582032 108.304688h-27.144531c5.316406-4.96875 9.898437-10.707032 13.574219-17.035157 3.675781 6.328125 8.257812 12.066407 13.570312 17.035157zm-77.722656-108.304688c29.859375 0 54.152344 24.292969 54.152344 54.152344s-24.292969 54.152344-54.152344 54.152344-54.152344-24.292969-54.152344-54.152344 24.292969-54.152344 54.152344-54.152344zm-50.582031 108.304688h-27.144531c5.316406-4.96875 9.898437-10.707032 13.574218-17.035157 3.675782 6.328125 8.253906 12.066407 13.570313 17.035157zm-131.875-54.152344c0-29.859375 24.292969-54.152344 54.152343-54.152344 29.859376 0 54.152344 24.292969 54.152344 54.152344s-24.292968 54.152344-54.152344 54.152344c-29.859374 0-54.152343-24.292969-54.152343-54.152344zm-18.882813 89.847656c-4.328125 0-7.847656-3.519531-7.847656-7.847656s3.519531-7.847656 7.847656-7.847656h402.679688c4.324218 0 7.847656 3.519531 7.847656 7.847656s-3.523438 7.847656-7.847656 7.847656zm18.882813 74.152344c0-29.859375 24.292969-54.152344 54.152343-54.152344 29.859376 0 54.152344 24.292969 54.152344 54.152344s-24.292968 54.152344-54.152344 54.152344c-29.859374 0-54.152343-24.292969-54.152343-54.152344zm0 164c0-29.859375 24.292969-54.152344 54.152343-54.152344 29.859376 0 54.152344 24.292969 54.152344 54.152344s-24.292968 54.152344-54.152344 54.152344c-29.859374 0-54.152343-24.292969-54.152343-54.152344zm236.609375 0c0 29.859375-24.292969 54.152344-54.152344 54.152344s-54.152344-24.292969-54.152344-54.152344 24.292969-54.152344 54.152344-54.152344 54.152344 24.292969 54.152344 54.152344zm-3.570313-54.152344h27.140625c-5.3125 4.96875-9.894531 10.703125-13.570312 17.035156-3.675782-6.332031-8.257813-12.066406-13.570313-17.035156zm-114.734375 17.035156c-3.675781-6.328125-8.257812-12.066406-13.570312-17.035156h27.140625c-5.316407 4.96875-9.894531 10.703125-13.570313 17.035156zm-13.570312 91.269532c5.3125-4.96875 9.894531-10.703126 13.570312-17.035157 3.675782 6.328125 8.257813 12.066407 13.570313 17.035157zm128.304687 0c5.3125-4.96875 9.894531-10.703126 13.570313-17.035157 3.675781 6.328125 8.257812 12.066407 13.570312 17.035157zm131.875-54.152344c0 29.859375-24.292969 54.152344-54.152343 54.152344-29.859376 0-54.152344-24.292969-54.152344-54.152344s24.292968-54.152344 54.152344-54.152344c29.859374 0 54.152343 24.292969 54.152343 54.152344zm-383.796875-74.152344c-4.328125 0-7.847656-3.519531-7.847656-7.847656s3.519531-7.847656 7.847656-7.847656h402.679688c4.324218 0 7.847656 3.519531 7.847656 7.847656s-3.523438 7.847656-7.847656 7.847656zm0 0"/><path d="m100.882812 208.152344c-16.542968 0-30 13.457031-30 30 0 16.542968 13.457032 30 30 30 16.542969 0 30-13.457032 30-30 0-16.542969-13.457031-30-30-30zm0 40c-5.515624 0-10-4.488282-10-10 0-5.515625 4.484376-10 10-10 5.511719 0 10 4.484375 10 10 0 5.511718-4.488281 10-10 10zm0 0"/><path d="m229.1875 208.152344c-16.542969 0-30 13.457031-30 30 0 16.542968 13.457031 30 30 30s30-13.457032 30-30c0-16.542969-13.457031-30-30-30zm0 40c-5.515625 0-10-4.488282-10-10 0-5.515625 4.484375-10 10-10 5.511719 0 10 4.484375 10 10 0 5.511718-4.488281 10-10 10zm0 0"/><path d="m357.492188 268.152344c16.542968 0 30-13.457032 30-30 0-16.542969-13.457032-30-30-30-16.542969 0-30 13.457031-30 30 0 16.542968 13.457031 30 30 30zm0-40c5.515624 0 10 4.484375 10 10 0 5.511718-4.484376 10-10 10-5.515626 0-10-4.488282-10-10 0-5.515625 4.484374-10 10-10zm0 0"/><path d="m100.882812 44.152344c-16.542968 0-30 13.457031-30 30 0 16.542968 13.457032 30 30 30 16.542969 0 30-13.457032 30-30 0-16.542969-13.457031-30-30-30zm0 40c-5.515624 0-10-4.488282-10-10 0-5.515625 4.484376-10 10-10 5.511719 0 10 4.484375 10 10 0 5.511718-4.488281 10-10 10zm0 0"/><path d="m229.1875 104.152344c16.542969 0 30-13.457032 30-30 0-16.542969-13.457031-30-30-30s-30 13.457031-30 30c0 16.542968 13.457031 30 30 30zm0-40c5.511719 0 10 4.484375 10 10 0 5.511718-4.488281 10-10 10-5.515625 0-10-4.488282-10-10 0-5.515625 4.484375-10 10-10zm0 0"/><path d="m357.492188 104.152344c16.542968 0 30-13.457032 30-30 0-16.542969-13.457032-30-30-30-16.542969 0-30 13.457031-30 30 0 16.542968 13.457031 30 30 30zm0-40c5.515624 0 10 4.484375 10 10 0 5.511718-4.484376 10-10 10-5.515626 0-10-4.488282-10-10 0-5.515625 4.484374-10 10-10zm0 0"/>
                </svg>
                <p className="cave-card__footer --text">7 bouteilles contenues</p>
            </div>

        </div>
    );
}

export default CardCave;